# UI_SPEC v2.1（最终 UI 方案 / 可交付给 Codex）
**定位**：AI-First 本地效率 App 的最终 UI/UX 规范（基于 PRD v1.1 的功能闭环，进行“产品感”重构）  
**适用平台**：Windows（主）/ Android（同构）  
**关键词**：Chat-first、两栏布局、iOS 清爽圆润、列表高密度、详情全屏推入、显式编辑模式、少量筛选（不入左栏）

---

## 0. 术语统一（必须全局一致）
- **“收藏”统一改为 “链接”**（UI、路由、设置分组、空态文案、按钮、日志）
- 资料库内部三段切换固定为：**待办 / 笔记 / 链接**

---

## 1. 设计原则（写死）
1) **默认从收件箱开始（Chat-first）**：像 Claude/Slack 的对话流驱动工作。  
2) **资料库是结果管理**：资料库不承担“输入入口”，新建靠按钮/快捷键，不用底部输入框。  
3) **左侧导航静态化**：不需要左侧动态过滤器（Today/Upcoming/已完成等都禁止放左栏）。  
4) **高密度但不乱**：靠对齐、弱化 meta、二行布局实现密度；禁止堆满多行 chip。  
5) **详情全屏推入**：点击列表项 → Main 区推入详情页（有返回），不使用右侧详情栏/弹窗为主。  
6) **编辑显式进入编辑模式**：默认只读，点“编辑”进入编辑模式，显式“保存/取消”，取消不写 DB。  
7) **中文友好**：关键路径提示与错误中文可读；关键操作有轻提示（首次 AI、首次同步、首次备份）。

---

## 2. 布局与导航

### 2.1 桌面两栏（Windows）
- **左侧 Sidebar**：固定宽 260–300（可折叠为窄模式）
- **右侧 Main**：列表页 / 详情页 / 搜索页（详情页占 Main 全屏）

### 2.2 Android（同构）
- Sidebar 作为 Drawer（汉堡按钮/左滑）
- Main 页面层级与 Windows 一致（列表 → 推入详情）

---

## 3. 信息架构（Sidebar 静态，无动态过滤器）

### 3.1 主入口（固定）
1) **收件箱**（默认选中）
2) **资料库**
3) **专注**

### 3.2 工具入口（固定）
- **搜索**
- **标签**（可折叠标签列表；点标签进入“标签结果页”）

### 3.3 系统入口（固定）
- **设置**
- **维护**
- （可选）**状态条**：AI / 同步 / 备份 / 通知（仅展示状态；点击跳转到设置对应分组）

> 禁止把“通知/主题”等入口挂在“同步/备份”下面。所有入口必须语义匹配。

---

## 4. 收件箱（唯一输入入口）

### 4.1 页面结构
- 中部：对话流（按时间顺序，不分会话/线程）
- 底部：**唯一常驻输入框**
- 流里包含：
  - 用户输入
  - AI 预览卡（未落库）
  - 草稿卡（失败回退，可重试/删除）
  - 系统消息（保存成功/失败提示）

### 4.2 交互：AI 先预览再落库（默认）
- 用户发送 → Router 返回 action + payload → UI 展示预览卡  
- 预览卡必须提供：
  - 类型标签：待办/笔记/链接/搜索/专注/维护
  - 结构化字段（可编辑）
  - 按钮：**确认保存 / 取消 / 重新生成（可选）**
- **必须点击确认才写 DB**（默认）

---

## 5. 资料库（类型视图 + 少量筛选）

### 5.1 顶部结构
- Segmented：**待办 / 笔记 / 链接**
- 右侧工具：搜索跳转、筛选 Popover、排序 Popover、多选按钮、（可选）+新建按钮

### 5.2 少量筛选（只在资料库页内，不进左栏）
仅允许以下筛选：
- 待办：**未完成 / 已完成**（或“显示已完成”开关）
- 待办：**有提醒 / 无提醒**
（可选）优先级筛选：高/中/低（若保持“少量”定义；否则不做）

笔记/链接不做复杂筛选（默认靠标签页与搜索）。

### 5.3 列表高密度模板（统一对齐规则）
#### 待办行（两行）
- 第一行：checkbox + title（1 行省略） +（右侧）优先级小点 + 提醒图标（有才显示）
- 第二行：标签 chips 最多 3 + “+N”  
- done：灰色 + 删除线弱化

#### 笔记行（两行）
- 第一行：title（1 行）
- 第二行：标签 chips（最多 3 + +N） +（右侧）vN

#### 链接行（两行）
- 第一行：title（空则 domain/url）
- 第二行：标签 chips（最多 3 + +N）

### 5.4 新建入口（资料库不显示常驻输入框）
- 资料库右上角：**+ 新建**（小菜单：待办/笔记/链接）
- 快捷键可触发新建（如 Ctrl+N，或 Ctrl+K 回到收件箱输入）

---

## 6. 标签结果页（按三段切换）
Sidebar 点击某标签 → Main 打开“标签：xxx”页面：
- 顶部标题：标签：xxx（带返回）
- Segmented：待办/笔记/链接
- 待办页允许少量筛选（同资料库规则）

---

## 7. 详情页（全屏推入式）+ 显式编辑模式

### 7.1 详情页导航
- 列表点击 → 推入详情页（Main 替换），Sidebar 保留
- 顶部：返回 / 标题 / 操作（编辑、删除、更多）

### 7.2 编辑模式（显式保存/取消）
- 默认只读
- 点击“编辑”进入编辑模式，显示：**保存 / 取消**
- 取消：不写 DB
- 保存：写 updated_at + lamport，并 upsert FTS

### 7.3 各实体详情最低功能
#### 待办详情
- title、priority、tags、remind_at、status
- 删除（确认弹窗）

#### 笔记详情
- 默认展示 organized_md（只读渲染）
- “查看原文”入口
- 版本管理：列表/切换查看/删除旧版本（保留最新）
- 重新整理：支持取消；可输入一行“整理偏好指令”（可选）

#### 链接详情
- title、url（可点击打开）
- 刷新标题（只抓 <title>）
- tags、删除

---

## 8. 搜索页（传统）+ AI deep 默认开
- 顶部搜索框自动聚焦，回车搜索
- 类型筛选 chips：待办/笔记/链接
- 结果列表：命中片段高亮，点击直达详情
- deep 默认开启：
  - 三阶段条：规划→检索→重排（可折叠）
  - deep 失败自动降级本地 + 中文提示（不中断）

---

## 9. 设置 IA（必须语义匹配）
设置页分组固定：
1) AI 与模型  
2) 同步  
3) 备份与恢复  
4) 通知与提醒  
5) 外观  
6) 维护  
7) 关于与诊断  

---

## 10. 视觉规范（参考 Apple Notes / Bear / Slack iOS）
- 圆角：12–16
- 阴影：极轻（更多靠分割线与留白）
- 字体层级：title 16–17，meta 12–13
- 颜色克制：优先级只用小点/细条，不用大块高饱和
- 空态：小图标 + 一句话（中文）
- 动效：轻量 Fade/Size；列表与详情推入有微过渡但不做重动画

---

## 11. Codex UI 重构任务拆分（建议按提交）
1) 全局文案与路由：收藏→链接（strings、页面标题、模型命名）  
2) Sidebar IA 静态化：收件箱/资料库/专注 + 搜索/标签 + 设置/维护 + 状态条  
3) 输入入口收敛：底部输入框仅在收件箱；资料库用 + 新建 + 快捷键  
4) 资料库少量筛选：只对待办提供“已完成/未完成”“有提醒/无提醒” Popover  
5) 标签结果页：标签→三段切换页面（待办/笔记/链接）  
6) 详情页统一推入式 + 编辑模式（保存/取消）  
7) 视觉 tokens：iOS 风默认主题 + 统一排版对齐  
8) 回归与验收：1000 条滚动仍顺；关键路径中文文案一致；deep 失败降级稳定

---

## 12. 验收标准（重构完成即通过）
- 收件箱默认选中，底部输入框只出现在收件箱
- 资料库只有三段：待办/笔记/链接；无 All
- Sidebar 不出现动态过滤器（Today/Upcoming 等）
- 详情页为推入式全屏，编辑需显式保存/取消
- 标签页按三段切换展示
- 搜索页 deep 默认开，失败降级本地不中断
- 全局所有“收藏”已替换为“链接”
