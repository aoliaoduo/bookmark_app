# AIOS Windows Beta 回归清单

执行环境建议：Windows 10/11，清理旧缓存后从 `flutter run -d windows` 或发布包启动。

使用方式：
- 每条执行后标记 `PASS/FAIL`。
- `FAIL` 时记录复现步骤、截图、诊断包路径。

## 1) UI v2.1 核心路径
1. `Drawer` 一级入口仅有：收件箱/资料库/专注。  
   预期：无底栏，无 Today/Upcoming 等动态过滤器入口。
2. 打开资料库页，顶部为三段切换：待办/笔记/链接。  
   预期：切换稳定，列表保留各自滚动位置。
3. 资料库右上 `+ 新建` 菜单可见。  
   预期：包含待办/笔记/链接三项，跳转收件箱并聚焦输入。
4. 从资料库点击任一条目进入详情页（push route）。  
   预期：主区域推入详情，支持返回。
5. 详情页默认只读，点击编辑后出现保存/取消。  
   预期：取消不落库，保存后列表即时刷新。
6. 标签入口为静态“工具”项，点击标签进入“标签：xxx”结果页。  
   预期：标签结果页同样是待办/笔记/链接三段切换。

## 2) AI Provider + Router
7. 设置 AI Provider（base_url/api_key）后保存。  
   预期：保存成功，可再次打开读取。
8. 点击“刷新模型列表”。  
   预期：模型可加载并可选中。
9. 点击“测试连接”。  
   预期：显示成功/失败与耗时。
10. 点击“批量测试模型”，中途点击停止。  
    预期：并发批测可运行，停止后不再调度后续项。
11. 收件箱发送自然语言，进入 AI 预览并确认保存。  
    预期：生成 action 并落库到对应实体。
12. 模拟 Router 解析失败（断网或错误模型）。  
    预期：写入 `inbox_drafts`，可在草稿列表重试/删除。

## 3) Note 版本链路
13. 打开笔记详情，默认显示整理版。  
    预期：raw_text 不默认暴露，仅通过“查看原文”入口访问。
14. 在笔记详情切换历史版本查看。  
    预期：切换只影响展示，不改 `latest_version`。
15. 点击“重新整理”，输入偏好指令并执行。  
    预期：生成新版本（version+1），可见 loading。
16. 重新整理过程中点击取消。  
    预期：停止后续写入，不产生半成品版本。

## 4) 链接（Bookmark/Link）链路
17. 单条链接点击“刷新标题”。  
    预期：仅解析 `<title>`，更新标题与 `last_fetched_at`。
18. 链接列表进入多选并执行“全选”。  
    预期：全选语义符合当前实现说明，选中计数正确。
19. 对选中项执行批量刷新，并在中途取消。  
    预期：进度可见，取消后不再处理后续队列。
20. 链接详情可点击 URL 打开外部浏览器。  
    预期：可正常跳转，无崩溃。

## 5) 搜索链路
21. 本地搜索输入关键词并回车。  
    预期：按类型分组返回，可点击直达详情。
22. 打开 AI deep（默认开）执行搜索。  
    预期：显示“规划→检索→重排”三个阶段。
23. 模拟 deep 失败（断网/模型错误）。  
    预期：自动降级为本地搜索，中文提示明确，不写入草稿队列。
24. 搜索结果命中理由可复制。  
    预期：复制成功提示出现。

## 6) 专注计时与本地通知
25. Countdown 设定 25 分钟并开始。  
    预期：计时运行，到点自动进入休息阶段。
26. Countup 开始 15 分钟后停止。  
    预期：休息时长= `floor(900/5)=180s`（至少 60s）。
27. 专注中 pause/resume/stop。  
    预期：中断不判失败，状态持久化恢复正常。
28. 点击“10 秒通知自检”。  
    预期：Windows 10 秒后收到系统通知。

## 7) 同步/备份/通知渠道
29. Sync 页填 WebDAV 配置并测试连接。  
    预期：连接成功或返回可读中文错误。
30. 连续点击“手动同步”。  
    预期：命中 120s 节流策略时有提示，不崩溃。
31. 触发同步错误后从状态条复制错误。  
    预期：可复制，便于反馈。
32. 备份设置默认 14:00，执行“立即备份”。  
    预期：云端生成 zip，状态显示最近成功时间。
33. 从云端列表执行恢复。  
    预期：恢复前自动生成本地临时备份，可见路径提示。
34. 通知渠道中配置飞书并“测试发送”。  
    预期：测试任务发送成功或失败可见。
35. 配置 SMTP 并“测试发送”。  
    预期：邮件发送成功或失败可见。
36. 制造发送失败后观察队列重试。  
    预期：`attempts` 增加，`next_retry_at` 按指数退避更新。

## 8) 发布与诊断
37. 从设置-关于与诊断导出诊断包（默认脱敏）。  
    预期：生成 zip，包含 `diagnostics.json` 与 `summary.txt`，默认不含 api_key 明文。
38. 开启“包含敏感信息”并导出。  
    预期：出现二次确认；确认后导出成功。
39. 执行 Portable 包启动验证。  
    预期：解压后直接运行 `code.exe` 可启动。
40. 执行 MSIX 安装验证（已信任证书）。  
    预期：可安装、可启动、可卸载。
